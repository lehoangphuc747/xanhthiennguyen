---
import Layout from '../layouts/Layout.astro';
---

<Layout title="ĐÔNG KHÔNG LẠNH 2025 - Xanh Đi">
  <!-- Snowfall Animation Container -->
  <div class="snowfall-container"></div>
  
  <div class="winter-scene min-h-screen pt-32 pb-32">
    <div class="container mx-auto px-4 sm:px-6">
      <div class="max-w-2xl mx-auto">
        {/* Header */}
        <div class="mb-12 text-center winter-header">
          <h1 class="winter-title">
            ĐÔNG KHÔNG LẠNH 2025
          </h1>
          <p class="winter-subtitle">
            Chương trình hỗ trợ cộng đồng trong mùa đông
          </p>
        </div>

        {/* Form Container */}
        <div class="winter-card">
          <form 
            id="dongkhonglanh-form"
          >
            
            {/* Câu hỏi 1: Radio với giá trị a, b, B, d */}
            <div class="form-group">
              <label class="form-label">
                Câu hỏi không có tiêu đề <span class="required-mark">*</span>
              </label>
              <div class="radio-group">
                <div class="radio-item">
                  <input 
                    type="radio" 
                    id="q1-a" 
                    name="entry.740864047" 
                    value="a"
                    required
                    class="radio-input"
                  />
                  <label for="q1-a" class="radio-label">
                    a
                  </label>
                </div>
                <div class="radio-item">
                  <input 
                    type="radio" 
                    id="q1-b" 
                    name="entry.740864047" 
                    value="b"
                    class="radio-input"
                  />
                  <label for="q1-b" class="radio-label">
                    b
                  </label>
                </div>
                <div class="radio-item">
                  <input 
                    type="radio" 
                    id="q1-B" 
                    name="entry.740864047" 
                    value="B"
                    class="radio-input"
                  />
                  <label for="q1-B" class="radio-label">
                    B
                  </label>
                </div>
                <div class="radio-item">
                  <input 
                    type="radio" 
                    id="q1-d" 
                    name="entry.740864047" 
                    value="d"
                    class="radio-input"
                  />
                  <label for="q1-d" class="radio-label">
                    d
                  </label>
                </div>
              </div>
            </div>
            
            {/* Câu hỏi 2: Text input */}
            <div class="form-group">
              <label for="field2" class="form-label">
                <span class="required-mark">*</span>
              </label>
              <input 
                type="text" 
                id="field2" 
                name="entry.1864959661" 
                required
                class="text-input"
                placeholder="Câu trả lời của bạn"
              />
            </div>
            
            {/* Câu hỏi 3: Checkboxes */}
            <div class="form-group">
              <label class="form-label">
              </label>
              <div class="checkbox-group">
                <div class="checkbox-item">
                  <input 
                    type="checkbox" 
                    id="option1" 
                    name="entry.1887314237" 
                    value="Tùy chọn 1"
                    class="checkbox-input"
                  />
                  <label for="option1" class="checkbox-label">
                    Tùy chọn 1
                  </label>
                </div>
                <div class="checkbox-item">
                  <input 
                    type="checkbox" 
                    id="option2" 
                    name="entry.1887314237" 
                    value="Tùy chọn 2"
                    class="checkbox-input"
                  />
                  <label for="option2" class="checkbox-label">
                    Tùy chọn 2
                  </label>
                </div>
                <div class="checkbox-item">
                  <input 
                    type="checkbox" 
                    id="option3" 
                    name="entry.1887314237" 
                    value="Tùy chọn 3"
                    class="checkbox-input"
                  />
                  <label for="option3" class="checkbox-label">
                    Tùy chọn 3
                  </label>
                </div>
                <div class="checkbox-item">
                  <input 
                    type="checkbox" 
                    id="option4" 
                    name="entry.1887314237" 
                    value="Tùy chọn 4"
                    class="checkbox-input"
                  />
                  <label for="option4" class="checkbox-label">
                    Tùy chọn 4
                  </label>
                </div>
              </div>
            </div>
            
            {/* Câu hỏi 4: Radio button đơn */}
            <div class="form-group">
              <label class="form-label">
              </label>
              <div class="radio-group">
                <div class="radio-item">
                  <input 
                    type="radio" 
                    id="choice1" 
                    name="entry.1752870187" 
                    value="Tùy chọn 1"
                    class="radio-input"
                  />
                  <label for="choice1" class="radio-label">
                    Tùy chọn 1
                  </label>
                </div>
              </div>
            </div>
            
            {/* Submit Button */}
            <button 
              type="submit"
              class="winter-button"
            >
              <span class="button-text">Gửi Đăng Ký</span>
              <span class="button-glow"></span>
            </button>
          </form>
          
          {/* Success Message */}
          <div 
            id="success-message" 
            class="message-box success-message"
          >
            <p class="message-title">
              ✓ Cảm ơn bạn đã gửi đơn đăng ký!
            </p>
            <p class="message-subtitle">
              Chúng tôi sẽ liên hệ với bạn sớm nhất.
            </p>
          </div>

          {/* Error Message */}
          <div 
            id="error-message" 
            class="message-box error-message"
          >
            <p class="message-title">
              ✗ Có lỗi xảy ra. Vui lòng thử lại!
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Inter:wght@300;400;500;600&family=Dancing+Script:wght@400;600&display=swap');
    
    /* === Color Variables === */
    :root {
      --ivory: #FFFFF0;
      --earthy-beige: #E8DCC4;
      --warm-ash: #C4BDB6;
      --deep-terracotta: #B85C38;
      --mustard-yellow: #D4A574;
      --mulled-wine: #8B4049;
      --pine-green: #4A5F4F;
      --mocha-brown: #6B4E3D;
      --snow-white: rgba(255, 255, 255, 0.9);
    }

    /* === Background & Scene === */
    .winter-scene {
      background: linear-gradient(135deg, var(--ivory) 0%, var(--earthy-beige) 50%, var(--warm-ash) 100%);
      position: relative;
      overflow: hidden;
    }



    /* === Snowfall Animation === */
    .snowfall-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
      overflow: hidden;
    }

    @keyframes snowfall {
      0% {
        transform: translateY(-10px) translateX(0);
      }
      25% {
        transform: translateY(25vh) translateX(20px);
      }
      50% {
        transform: translateY(50vh) translateX(-10px);
      }
      75% {
        transform: translateY(75vh) translateX(15px);
      }
      100% {
        transform: translateY(100vh) translateX(-5px);
      }
    }

    .snowfall-container::before,
    .snowfall-container::after {
      content: '';
      position: absolute;
      top: -10px;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle, rgba(255, 255, 255, 1) 2px, transparent 2px),
        radial-gradient(circle, rgba(255, 255, 255, 0.95) 3px, transparent 3px),
        radial-gradient(circle, rgba(255, 255, 255, 0.9) 2.5px, transparent 2.5px),
        radial-gradient(circle, rgba(255, 255, 255, 1) 2px, transparent 2px);
      background-size: 120px 120px, 150px 150px, 100px 100px, 180px 180px;
      background-position: 0 0, 30px 40px, 60px 20px, 90px 70px;
      animation: snowfall 12s linear infinite;
      will-change: transform;
    }

    .snowfall-container::after {
      animation-duration: 15s;
      animation-delay: -6s;
      animation-iteration-count: infinite;
      opacity: 0.95;
    }

    /* === Header === */
    .winter-header {
      position: relative;
      z-index: 10;
    }

    .winter-title {
      font-family: 'Lora', serif;
      font-size: clamp(2.5rem, 6vw, 4rem);
      font-weight: 700;
      letter-spacing: 0.05em;
      color: var(--mocha-brown);
      text-shadow: 2px 2px 4px rgba(107, 78, 61, 0.1);
      margin-bottom: 1rem;
      line-height: 1.2;
    }

    .winter-subtitle {
      font-family: 'Dancing Script', cursive;
      font-size: clamp(1.25rem, 3vw, 1.75rem);
      font-weight: 600;
      color: var(--deep-terracotta);
      margin-bottom: 0;
    }

    /* === Form Card === */
    .winter-card {
      background: rgba(255, 255, 255, 0.75);
      border-radius: 20px;
      padding: 3rem 2.5rem;
      box-shadow: 0 10px 40px rgba(107, 78, 61, 0.15);
      border: 1px solid rgba(196, 189, 182, 0.3);
      position: relative;
      z-index: 10;
    }





    /* === Form Groups === */
    .form-group {
      margin-bottom: 2rem;
    }

    .form-label {
      font-family: 'Lora', serif;
      font-size: 1rem;
      font-weight: 600;
      color: var(--mocha-brown);
      display: block;
      margin-bottom: 0.75rem;
      letter-spacing: 0.02em;
    }

    .required-mark {
      color: var(--mulled-wine);
      margin-left: 0.25rem;
    }

    /* === Text Input === */
    .text-input {
      font-family: 'Inter', sans-serif;
      width: 100%;
      padding: 0.875rem 1.25rem;
      background: rgba(255, 255, 255, 0.7);
      border: 2px solid var(--warm-ash);
      border-radius: 12px;
      font-size: 1rem;
      color: var(--mocha-brown);
      transition: all 0.3s ease;
      line-height: 1.6;
    }

    .text-input::placeholder {
      color: rgba(107, 78, 61, 0.5);
      font-style: italic;
    }

    .text-input:focus {
      outline: none;
      border-color: var(--deep-terracotta);
      background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 0 0 4px rgba(184, 92, 56, 0.1);
    }

    /* === Radio & Checkbox Groups === */
    .radio-group,
    .checkbox-group {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .radio-item,
    .checkbox-item {
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 10px;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
    }

    .radio-item input,
    .checkbox-item input {
      position: absolute;
      opacity: 0;
      cursor: pointer;
      width: 100%;
      height: 100%;
      left: 0;
      top: 0;
      margin: 0;
    }

    .radio-item::before,
    .checkbox-item::before {
      content: '';
      width: 20px;
      height: 20px;
      border: 2px solid var(--deep-terracotta);
      background: white;
      display: inline-block;
      flex-shrink: 0;
      transition: all 0.2s ease;
    }

    .radio-item::before {
      border-radius: 50%;
    }

    .checkbox-item::before {
      border-radius: 4px;
    }

    .radio-item:has(input:checked)::before {
      background: var(--deep-terracotta);
      box-shadow: inset 0 0 0 4px white;
    }

    .checkbox-item:has(input:checked)::before {
      background: var(--deep-terracotta);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z'/%3E%3C/svg%3E");
      background-size: 16px;
      background-position: center;
      background-repeat: no-repeat;
    }

    .radio-item:hover,
    .checkbox-item:hover {
      background: rgba(212, 165, 116, 0.2);
    }



    .radio-label,
    .checkbox-label {
      font-family: 'Inter', sans-serif;
      margin-left: 0.875rem;
      color: var(--mocha-brown);
      cursor: pointer;
      font-size: 0.975rem;
      line-height: 1.5;
      flex: 1;
      pointer-events: none;
    }

    /* === Submit Button === */
    .winter-button {
      width: 100%;
      padding: 1rem 2rem;
      background: linear-gradient(135deg, var(--deep-terracotta) 0%, var(--mulled-wine) 100%);
      border: none;
      border-radius: 12px;
      font-family: 'Lora', serif;
      font-size: 1.125rem;
      font-weight: 600;
      color: white;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      transition: all 0.4s ease;
      box-shadow: 0 4px 20px rgba(184, 92, 56, 0.3);
      margin-top: 1rem;
    }

    .button-text {
      position: relative;
      z-index: 2;
      display: block;
    }



    .winter-button:hover {
      opacity: 0.9;
    }

    .winter-button:active {
      opacity: 0.8;
    }

    /* === Messages === */
    .message-box {
      margin-top: 1.5rem;
      padding: 1.25rem 1.5rem;
      border-radius: 12px;
      display: none;
      animation: slideIn 0.4s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .message-box.show {
      display: block;
    }

    .success-message {
      background: rgba(74, 95, 79, 0.1);
      border: 2px solid var(--pine-green);
    }

    .error-message {
      background: rgba(139, 64, 73, 0.1);
      border: 2px solid var(--mulled-wine);
    }

    .message-title {
      font-family: 'Lora', serif;
      font-size: 1.125rem;
      font-weight: 600;
      text-align: center;
      margin-bottom: 0.5rem;
      color: var(--mocha-brown);
    }

    .message-subtitle {
      font-family: 'Inter', sans-serif;
      font-size: 0.925rem;
      text-align: center;
      color: rgba(107, 78, 61, 0.8);
      margin: 0;
    }

    /* === Responsive === */
    @media (max-width: 640px) {
      .winter-card {
        padding: 2rem 1.5rem;
      }

      .winter-title {
        font-size: 2rem;
      }

      .winter-subtitle {
        font-size: 1.75rem;
      }
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSceSqTicrC7M0G_JWLRlt5ML2tzScnyxILGimAzL1NpgSF1yg/formResponse";
      
      const form = document.getElementById('dongkhonglanh-form') as HTMLFormElement | null;
      const successMessage = document.getElementById('success-message');
      const errorMessage = document.getElementById('error-message');
      
      form?.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Reset message visibility
        successMessage?.classList.add('hidden');
        errorMessage?.classList.add('hidden');
        
        // Validate text field (entry.740864047) - BÂY GIỜ LÀ RADIO BUTTON
        const radioQ1 = form.querySelector('input[name="entry.740864047"]:checked');
        if (!radioQ1) {
          alert('Vui lòng chọn câu trả lời cho câu hỏi đầu tiên!');
          return;
        }
        
        // Validate text field (entry.1864959661)
        const textField = form.querySelector('input[name="entry.1864959661"]') as HTMLInputElement;
        if (!textField || !textField.value.trim()) {
          alert('Vui lòng nhập câu trả lời!');
          textField?.focus();
          return;
        }
        
        // Checkboxes (entry.1887314237) - KHÔNG BẮT BUỘC
        // Không cần validate
        
        // Radio button (entry.1752870187) - KHÔNG BẮT BUỘC
        // Không cần validate}
        
        try {
          const formData = new FormData(form);
          
          // Gửi dữ liệu với fetch API
          await fetch(FORM_URL, {
            method: 'POST',
            mode: 'no-cors',
            body: formData
          });
          
          // Hiển thị thông báo thành công
          successMessage?.classList.remove('hidden');
          successMessage?.classList.add('show');
          form.reset();
          
          // Scroll to success message
          successMessage?.scrollIntoView({ behavior: 'smooth', block: 'center' });
          
        } catch (error) {
          console.error('Form submission error:', error);
          errorMessage?.classList.remove('hidden');
          errorMessage?.classList.add('show');
          errorMessage?.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      });
    });
  </script>
</Layout>
